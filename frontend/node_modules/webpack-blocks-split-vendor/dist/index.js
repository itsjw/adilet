'use strict';

var _webpack = require('@webpack-blocks/webpack2');

var _webpackMd5Hash = require('webpack-md5-hash');

var _webpackMd5Hash2 = _interopRequireDefault(_webpackMd5Hash);

var _utils = require('./utils');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Returns a webpack block that splits vendor javascript bundle.
 */
const splitVendor = options => {
  var _ref = typeof options === 'object' ? options : { name: options, exclude: undefined },
      _ref$name = _ref.name;

  const name = _ref$name === undefined ? 'vendor' : _ref$name,
        exclude = _ref.exclude;


  return (0, _webpack.group)([(0, _webpack.setOutput)({
    filename: '[name].js'
  }), (0, _webpack.addPlugins)([new _webpack.webpack.optimize.CommonsChunkPlugin({
    minChunks: (0, _utils.isVendor)(exclude),
    name
  })]), (0, _webpack.env)('production', [(0, _webpack.setOutput)({
    filename: '[name].[chunkhash].js'
  }), (0, _webpack.addPlugins)([new _webpackMd5Hash2.default()])])]);
};


module.exports = splitVendor;